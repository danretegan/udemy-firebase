{"mappings":"AAAA,IAAMA,KAAOC,SAASC,cAAc,MAC9BC,KAAOF,SAASC,cAAc,QAE9BE,UAAY,SAACC,EAAQC,GAEzB,IAAIC,EAAO,sBAEJC,OADUF,EAAG,eAEEE,OADfH,EAAOI,MAAM,kCAEAD,OADEH,EAAOK,OAAO,wCACWF,OAA3BH,EAAOM,WAAWC,SAAS,6FAM/CZ,KAAKa,WAAaN,C,EAIdO,aAAe,SAAAR,GACJL,SAASc,iBAAiB,MAClCC,SAAQ,SAAAC,GACTA,EAAKC,aAAa,eAAiBZ,GACrCW,EAAKE,Q;;AAOXC,GAAGC,WAAW,WAAWC,YAAW,SAAAC,GAElCA,EAASC,aAAaR,SAAQ,SAAAS,GAE5B,IAAMC,EAAMD,EAAOC,IAEC,UAAhBD,EAAOE,KACTvB,UAAUsB,EAAIE,OAAQF,EAAIpB,IACD,YAAhBmB,EAAOE,MAChBb,aAAaY,EAAIpB,G;;AAMvBH,KAAK0B,iBAAiB,UAAU,SAAAC,GAC9BA,EAAEC,iBAEF,IAAMC,EAAM,IAAIC,KAGV5B,EAAS,CACbI,MAAON,KAAKE,OAAO6B,MACnBvB,WAAYwB,SAASC,UAAUC,UAAUC,SAASN,IAGpDZ,GAAGC,WAAW,WACXkB,IAAIlC,GACJmC,MAAK,WACJC,QAAQC,IAAI,gB,IAEbC,OAAM,SAAAC,GACLH,QAAQC,IAAIE,E;;AAKlB5C,KAAK6B,iBAAiB,SAAS,SAAAC,GAE7B,GAAyB,WAArBA,EAAEe,OAAOC,QAAsB,CACjC,IAAMxC,EAAKwB,EAAEe,OAAOE,cAAc7B,aAAa,aAE/CE,GAAGC,WAAW,WACXK,IAAIpB,GACJ0C,SACAR,MAAK,WACJC,QAAQC,IAAI,kB,IAEbC,OAAM,SAAAC,GACLH,QAAQC,IAAIE,E","sources":["src/index.js"],"sourcesContent":["const list = document.querySelector('ul');\nconst form = document.querySelector('form');\n\nconst addRecipe = (recipe, id) => {\n  //   console.log(recipe.created_at.toDate());\n  let html = `\n  <li recipe-id=\"${id}\">\n  <div>${recipe.title}</div>\n  <div><small>author: ${recipe.author}</small></div>\n  <div><small>date: ${recipe.created_at.toDate()}</small></div>\n  <button class=\"btn btn-danger btn-sm my-2\">delete</button>\n  </li>\n  `;\n\n  // console.log(html);\n  list.innerHTML += html;\n};\n\n//! functie de stergere reteta din UI:\nconst deleteRecipe = id => {\n  const retete = document.querySelectorAll('li');\n  retete.forEach(elem => {\n    if (elem.getAttribute('recipe-id') === id) {\n      elem.remove();\n    }\n  });\n};\n\n//! get documents:\n// TODO Real-time Listeners [.onSnapshot()]\ndb.collection('recipes').onSnapshot(snapshot => {\n  //   console.log(snapshot.docChanges());\n  snapshot.docChanges().forEach(change => {\n    // console.log(change);\n    const doc = change.doc;\n    // console.log(doc);\n    if (change.type === 'added') {\n      addRecipe(doc.data(), doc.id);\n    } else if (change.type === 'removed') {\n      deleteRecipe(doc.id);\n    }\n  });\n});\n\n//! add documents:\nform.addEventListener('submit', e => {\n  e.preventDefault();\n\n  const now = new Date();\n\n  //* Definim obiectul (documentul) si modalitatea de a obtine datele:\n  const recipe = {\n    title: form.recipe.value, // Obținem titlul rețetei din formular.\n    created_at: firebase.firestore.Timestamp.fromDate(now), // Setăm data curentă.\n  };\n\n  db.collection('recipes')\n    .add(recipe)\n    .then(() => {\n      console.log('recipe added!');\n    })\n    .catch(err => {\n      console.log(err);\n    });\n});\n\n//! deleting data:\nlist.addEventListener('click', e => {\n  //   console.log(e);\n  if (e.target.tagName === 'BUTTON') {\n    const id = e.target.parentElement.getAttribute('recipe-id');\n    // console.log(id);\n    db.collection('recipes')\n      .doc(id)\n      .delete()\n      .then(() => {\n        console.log('recipe deleted!');\n      })\n      .catch(err => {\n        console.log(err);\n      });\n  }\n});\n"],"names":["list","document","querySelector","form","addRecipe","recipe","id","html","concat","title","author","created_at","toDate","innerHTML","deleteRecipe","querySelectorAll","forEach","elem","getAttribute","remove","db","collection","onSnapshot","snapshot","docChanges","change","doc","type","data","addEventListener","e","preventDefault","now","Date","value","firebase","firestore","Timestamp","fromDate","add","then","console","log","catch","err","target","tagName","parentElement","delete"],"version":3,"file":"index.34a68b3f.js.map"}